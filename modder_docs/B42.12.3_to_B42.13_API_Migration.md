Below is a **clean, authoritative consolidation and clarification** of the **Build 42.12.3 → 42.13 API migration changes** you listed, with practical implications for mod maintenance and multiplayer safety. This aligns with the official migration material in the uploaded guides  .

> by Slayer
---

## 1. `WeaponType` → Enum Renaming (1:1)

There are **no semantic changes**. This is a strict renaming to comply with enum naming conventions (uppercase, snake case).

| Build 42.12.3          | Build 42.13             |
| ---------------------- | ----------------------- |
| `WeaponType.barehands` | `WeaponType.UNARMED`    |
| `WeaponType.twohanded` | `WeaponType.TWO_HANDED` |
| `WeaponType.onehanded` | `WeaponType.ONE_HANDED` |
| `WeaponType.heavy`     | `WeaponType.HEAVY`      |
| `WeaponType.knife`     | `WeaponType.KNIFE`      |
| `WeaponType.spear`     | `WeaponType.SPEAR`      |
| `WeaponType.handgun`   | `WeaponType.HANDGUN`    |
| `WeaponType.firearm`   | `WeaponType.FIREARM`    |
| `WeaponType.throwing`  | `WeaponType.THROWING`   |
| `WeaponType.chainsaw`  | `WeaponType.CHAINSAW`   |

**Action required:**
Global search/replace. No logic changes required.

---

## 2. `PropertyContainer` Method Renames (1:1)

`PropertyContainer` remains functionally identical, but all methods were renamed for consistency.

| Old        | New        |
| ---------- | ---------- |
| `:Is()`    | `:has()`   |
| `:Val()`   | `:get()`   |
| `:Set()`   | `:set()`   |
| `:UnSet()` | `:unset()` |

**Example migration:**

```lua
-- old
if spriteProps:Is("solid") then
    local v = spriteProps:Val("burnt")
end

-- new
if spriteProps:has("solid") then
    local v = spriteProps:get("burnt")
end
```

---

## 3. `Stats` API → Generic Stat Access

All stat-specific setters/getters have been removed in favor of a **generic enum-based API**.

### Old

```lua
player:getStats():setPanic(0)
local panic = player:getStats():getPanic()
```

### New

```lua
player:getStats():set(CharacterStat.PANIC, 0)
local panic = player:getStats():get(CharacterStat.PANIC)
```

**Implications:**

* Cleaner API surface
* Easier future stat expansion
* Enables safer server-side validation

---

## 4. Traits → `CharacterTrait` Enum + Registry

### Old

```lua
player:HasTrait("EagleEyed")
```

### New

```lua
player:hasTrait(CharacterTrait.EAGLE_EYED)
```

### Custom Traits (Required Pattern)

Custom traits **must be registered** in `media/registries.lua` and **cached globally**.

```lua
-- media/registries.lua
MyModRegistries = MyModRegistries or {}
MyModRegistries.CharacterTraits = {}

MyModRegistries.CharacterTraits.GOAT =
    CharacterTrait.register("BWO:goat")
```

Usage anywhere else:

```lua
if player:hasTrait(MyModRegistries.CharacterTraits.GOAT) then
    -- logic
end
```

**Why this matters:**

* Prevents string mismatches
* Ensures script ↔ Lua ↔ Java consistency
* Required for MP-safe resolution 

---

## 5. `ItemBodyLocation` → Enum-Based

String-based body locations are deprecated.

### Old

```lua
player:setWornItem("Dress", item)
```

### New

```lua
player:setWornItem(ItemBodyLocation.DRESS, item)
```

### Backward Compatibility Helper

```lua
ItemBodyLocation.get(ResourceLocation.of("Dress"))
```

This helper is critical when migrating older mods or reading legacy data.

---

## 6. Player Damage → **Server-Only Authority**

This is **not cosmetic**—it is a fundamental multiplayer security change.

### No Longer Valid Client-Side

* `player:Hit()`
* `setScratched()`
* `setCut()`
* `generateDeepWound()`
* Any direct health or body-part mutation

### Required Pattern

1. **Client** sends intent:

```lua
sendClientCommand(player, "MyMod", "applyDamage", {
    type = "scratch",
    bodyPart = "Hand_L"
})
```

2. **Server** validates and applies:

```lua
function Commands.applyDamage(player, args)
    local bp = player:getBodyDamage():getBodyPart(BodyPartType.Hand_L)
    bp:setScratched(true)
end
```

**Rationale:**

* Prevents cheating
* Ensures authoritative health state
* Aligns with the server-side inventory and timed-action model 

---

## 7. Strategic Migration Guidance

**Recommended order of work:**

1. Enum renames (`WeaponType`, `ItemBodyLocation`)
2. `PropertyContainer` method updates
3. `Stats` refactor
4. Trait migration + registry introduction
5. Audit all player damage and health code paths for server-only execution

**High-risk areas to audit carefully:**

* Client-side hit reactions
* Teleport / forced movement mods
* Custom combat or trap systems
* Any mod that previously altered body parts directly

---
